## Overview

!!! info
    [基本概念&分类](https://ckc-agc.bowling233.top/programming/common/notes/pointers/)


!!! info
    [指针易错题-tonycrane](https://note.tonycrane.cc/cs/pl/c_cpp/c/)
    [指针注意项-wu](https://wu-wu-u.github.io/Notebooks/cs/pl/c_cpp/C/c/#_4)


---

以下转载自竺院辅学网站

# 指针概览

你可能已经听说过，C 语言是贴近底层的编程语言。这是因为，C 语言未对计算机硬件作过多抽象，它方便而又灵活的语言特性为与硬件交互提供了极大便利。

指针是 C 语言的核心特性之一，它的灵活性与强大性，使得 C 语言成为与硬件交互的首选语言。但是，指针也是 C 语言中最容易引发错误的特性之一，它要求使用者正确理解内存模型，并对指针的使用严加约束。

本文将尽量全面地讲解指针的定义与特性，并梳理部分使用技巧。在此之前，为了准确理解指针，我们需要先了解 C 语言的内存模型与对象模型。

!!! tip "阅读提示"

    程算课程中学习的 C 语言语法均在 C99 标准规定的范围内。下文中，如果未作额外说明，所有内容均基于 C99 标准。

    下文中部分提示默认被折叠。此类提示为拓展内容，对知识积累与理解能力有一定要求，但有助于理解一些细节问题，请酌情阅读。

## 底层概念

### 内存模型

!!! note inline end "内存模型"

    ![](graph/pointers_addr.jpg)

    存储在内存中的一个字符串，其每个字节的索引、值与内存地址。
    
    （单击图片可放大）

在 C 语言的内存模型中，**字节（Byte）**定义为一系列连续的**位（bit）**，是内存的最小可寻址单元。在几乎所有现代计算机上，一个字节的长度都是 8 位，我们的讨论也基于这一标准。

所谓“可寻址”指的是内存中的所有字节都拥有一个唯一编号，也即**内存地址**。习惯上，内存地址由长度一定的、从 0 开始递增的无符号整数表示，其长度由操作系统决定。

??? info "常见架构中内存地址的长度"

    我们经常接触的处理器架构中，x86（又称 IA-32）架构使用 32 位长的内存地址，x86-64（又称 x64、AMD64、Intel 64）与 ARM64（又称 AArch64）架构使用 64 位长的内存地址。容易看出，x86 架构支持的最大内存空间只有 4 GB，而后两个架构支持的最大内存空间则远超前者。

### 对象

C 语言将程序使用的数据抽象为**对象**，它被定义为执行环境中内存的一个区域，其内容可以表示*特定类型的值*。根据数据类型与长度的不同，一个对象可占据一个或多个字节，我们称起始字节的内存地址为*该对象的内存地址*。

每个对象可以用 `memcpy` 复制到 `unsigned char[n]` 类型的对象中，我们称生成的数组内容为*对象表示*。方便起见，我们通常以十六进制整数序列形式展示对象表示，每两位十六进制数代表一个字节。举例来说，`int` 类型常量 `1` 在小端序计算机上的对象表示为 `0x01 00 00 00`。

另外，对象表示和值并不要求一一对应，两个值相等的对象可以拥有不同的对象表示。

除了直接使用**字面量**（常量的一种）创建对象外，还可以通过声明语句创建，并为其分配一个**标识符**，以掩盖分配内存空间与访问内存地址的细节过程，并增强程序可读性。

??? info "标识符"

    C 标准定义，标识符是数字、下划线、小写及大写拉丁字母的任意长度序列（不讨论 Unicode 字符）。合法的标识符必须以非数字字符开始，以区别于整数常量或浮点常量。

    > 标识符能指代下列类型的实体：
    >
    > - 对象
    > - 函数
    > - 标签（struct、union 或枚举）
    > - 结构体或联合体成员
    > - 枚举常量
    > - typedef 名
    > - 标号名
    > - 宏名
    > - 宏形参名
    >
    > 宏名或宏形参名以外的每个标识符都拥有作用域，并可以拥有链接。相同的标识符可以在程序的相异点指代相异实体。

    **关键字也属于标识符**，但它们被保留，不可在程序中声明。以一个或多个下划线开始的标识符也不应在程序中出现；根据约定，这些标识符应由库的内部实现使用。另外，还有一些标识符被指定保留，此处不再展开。

!!! warning "区分对象概念"

    如果你学习过或将要学习其他编程语言，请严格区分不同语言中的对象概念，尤其是面向对象语言中的“对象”。

因此，声明一个变量实际上包括两步：首先，为对象申请一块对应大小的内存空间；其次，将标识符与对象相关联。

当程序尝试读取或修改对象的内容时，我们称程序*访问*了该对象或该内存地址。
